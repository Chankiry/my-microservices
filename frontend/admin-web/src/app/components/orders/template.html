<nav class="navbar">
<div class="container" style="display: flex; justify-content: space-between; align-items: center;">
    <a class="navbar-brand" routerLink="/">Admin Dashboard</a>
    <div class="navbar-nav">
    <a class="nav-link" routerLink="/">Home</a>
    <a class="nav-link" routerLink="/dashboard">Dashboard</a>
    <a class="nav-link" routerLink="/users">Users</a>
    <a class="nav-link" routerLink="/orders">Orders</a>
    <a class="nav-link" routerLink="/payments">Payments</a>
    <a class="nav-link" routerLink="/notifications">Notifications</a>
    <button class="btn btn-danger" style="margin-left: 10px;" (click)="logout()">Logout</button>
    </div>
</div>
</nav>

<div class="container" style="padding-top: 30px;">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
    <h1>Order Management</h1>
    <button class="btn btn-primary" (click)="loadOrders()">Refresh</button>
</div>

<!-- Filters -->
<div class="card" style="margin-bottom: 20px;">
    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
    <div>
        <label style="display: block; margin-bottom: 5px; color: #666;">Status Filter</label>
        <select [(ngModel)]="statusFilter" (change)="loadOrders()" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
        <option value="">All Statuses</option>
        <option value="pending">Pending</option>
        <option value="processing">Processing</option>
        <option value="completed">Completed</option>
        <option value="cancelled">Cancelled</option>
        </select>
    </div>
    <div>
        <label style="display: block; margin-bottom: 5px; color: #666;">Items per page</label>
        <select [(ngModel)]="pageSize" (change)="loadOrders()" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px;">
        <option value="10">10</option>
        <option value="25">25</option>
        <option value="50">50</option>
        </select>
    </div>
    </div>
</div>

<!-- Orders Table -->
<div class="card">
    <div *ngIf="loading" style="text-align: center; padding: 40px;">
    <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #007bff; border-radius: 50%; animation: spin 1s linear infinite;"></div>
    <p style="margin-top: 15px; color: #666;">Loading orders...</p>
    </div>

    <div *ngIf="!loading && orders.length === 0" style="text-align: center; padding: 40px; color: #666;">
    <svg style="width: 64px; height: 64px; margin-bottom: 15px;" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" />
    </svg>
    <h3>No orders found</h3>
    <p>There are no orders in the system yet.</p>
    </div>

    <table *ngIf="!loading && orders.length > 0" style="width: 100%; border-collapse: collapse;">
    <thead>
        <tr style="border-bottom: 2px solid #ddd;">
        <th style="text-align: left; padding: 12px;">Order #</th>
        <th style="text-align: left; padding: 12px;">User ID</th>
        <th style="text-align: left; padding: 12px;">Date</th>
        <th style="text-align: left; padding: 12px;">Items</th>
        <th style="text-align: left; padding: 12px;">Status</th>
        <th style="text-align: right; padding: 12px;">Total</th>
        <th style="text-align: center; padding: 12px;">Actions</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let order of orders" style="border-bottom: 1px solid #eee;">
        <td style="padding: 12px; font-family: monospace;">{{ order.orderNumber }}</td>
        <td style="padding: 12px; font-family: monospace; font-size: 12px;">{{ order.userId | slice:0:8 }}...</td>
        <td style="padding: 12px;">{{ order.createdAt | date:'short' }}</td>
        <td style="padding: 12px;">{{ order.items?.length || 0 }}</td>
        <td style="padding: 12px;">
            <span [ngClass]="getStatusClass(order.status)" style="padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500;">
            {{ order.status }}
            </span>
        </td>
        <td style="padding: 12px; text-align: right; font-weight: 500;">${{ order.totalAmount }}</td>
        <td style="padding: 12px; text-align: center;">
            <button *ngIf="order.status === 'pending'" (click)="updateStatus(order.id, 'processing')" style="margin-right: 5px; padding: 4px 8px; background: #007bff; color: white; border: none; border-radius: 4px; font-size: 12px;">
            Process
            </button>
            <button *ngIf="order.status === 'processing'" (click)="updateStatus(order.id, 'completed')" style="margin-right: 5px; padding: 4px 8px; background: #28a745; color: white; border: none; border-radius: 4px; font-size: 12px;">
            Complete
            </button>
            <button *ngIf="order.status !== 'completed' && order.status !== 'cancelled'" (click)="cancelOrder(order.id)" style="padding: 4px 8px; background: #dc3545; color: white; border: none; border-radius: 4px; font-size: 12px;">
            Cancel
            </button>
        </td>
        </tr>
    </tbody>
    </table>

    <!-- Pagination -->
    <div *ngIf="!loading && totalPages > 1" style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
    <p style="color: #666;">Showing {{ (currentPage - 1) * pageSize + 1 }} - {{ Math.min(currentPage * pageSize, totalItems) }} of {{ totalItems }} orders</p>
    <div style="display: flex; gap: 5px;">
        <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1" style="padding: 8px 16px; border: 1px solid #ddd; background: white; border-radius: 4px; cursor: pointer;" [style.opacity]="currentPage === 1 ? '0.5' : '1'">
        Previous
        </button>
        <button *ngFor="let page of getPageNumbers()" (click)="goToPage(page)" style="padding: 8px 16px; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;" [style.background]="page === currentPage ? '#007bff' : 'white'" [style.color]="page === currentPage ? 'white' : 'inherit'">
        {{ page }}
        </button>
        <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages" style="padding: 8px 16px; border: 1px solid #ddd; background: white; border-radius: 4px; cursor: pointer;" [style.opacity]="currentPage === totalPages ? '0.5' : '1'">
        Next
        </button>
    </div>
    </div>
</div>
</div>

<style>
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>