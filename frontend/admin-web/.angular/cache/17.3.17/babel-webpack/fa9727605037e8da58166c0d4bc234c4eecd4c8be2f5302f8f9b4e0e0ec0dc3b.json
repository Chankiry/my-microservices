{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"keycloak-angular\";\nimport * as i2 from \"../../services/payment.service\";\nexport class PaymentsComponent {\n  constructor(keycloakService, paymentService) {\n    this.keycloakService = keycloakService;\n    this.paymentService = paymentService;\n    this.payments = [];\n    this.loading = true;\n    this.currentPage = 1;\n    this.pageSize = 10;\n    this.totalItems = 0;\n    this.totalPages = 0;\n    this.statusFilter = '';\n    this.selectedPayment = null;\n    this.Math = Math;\n    // Stats\n    this.totalPayments = 0;\n    this.completedPayments = 0;\n    this.pendingPayments = 0;\n    this.failedPayments = 0;\n  }\n  ngOnInit() {\n    this.loadPayments();\n  }\n  loadPayments() {\n    this.loading = true;\n    this.paymentService.getPayments({\n      page: this.currentPage,\n      limit: +this.pageSize\n    }).subscribe({\n      next: response => {\n        this.payments = this.statusFilter ? response.data.filter(p => p.status === this.statusFilter) : response.data;\n        this.totalItems = response.pagination.total;\n        this.totalPages = response.pagination.totalPages;\n        // Calculate stats\n        this.totalPayments = response.pagination.total;\n        this.completedPayments = response.data.filter(p => p.status === 'completed').length;\n        this.pendingPayments = response.data.filter(p => p.status === 'pending').length;\n        this.failedPayments = response.data.filter(p => p.status === 'failed').length;\n        this.loading = false;\n      },\n      error: err => {\n        console.error('Failed to load payments:', err);\n        this.loading = false;\n      }\n    });\n  }\n  viewDetails(payment) {\n    this.selectedPayment = payment;\n  }\n  refundPayment(paymentId) {\n    if (!confirm('Are you sure you want to refund this payment?')) return;\n    this.paymentService.refundPayment(paymentId, {\n      reason: 'Admin refund'\n    }).subscribe({\n      next: () => {\n        this.loadPayments();\n      },\n      error: err => {\n        console.error('Failed to refund payment:', err);\n        alert('Failed to refund payment');\n      }\n    });\n  }\n  goToPage(page) {\n    if (page < 1 || page > this.totalPages) return;\n    this.currentPage = page;\n    this.loadPayments();\n  }\n  getPageNumbers() {\n    const pages = [];\n    const start = Math.max(1, this.currentPage - 2);\n    const end = Math.min(this.totalPages, this.currentPage + 2);\n    for (let i = start; i <= end; i++) {\n      pages.push(i);\n    }\n    return pages;\n  }\n  getStatusClass(status) {\n    switch (status) {\n      case 'completed':\n        return 'bg-green-100 text-green-800';\n      case 'pending':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'processing':\n        return 'bg-blue-100 text-blue-800';\n      case 'failed':\n        return 'bg-red-100 text-red-800';\n      case 'refunded':\n        return 'bg-gray-100 text-gray-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  }\n  logout() {\n    this.keycloakService.logout();\n  }\n  static {\n    this.ɵfac = function PaymentsComponent_Factory(t) {\n      return new (t || PaymentsComponent)(i0.ɵɵdirectiveInject(i1.KeycloakService), i0.ɵɵdirectiveInject(i2.PaymentService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: PaymentsComponent,\n      selectors: [[\"app-payments\"]],\n      decls: 1,\n      vars: 0,\n      template: function PaymentsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵtext(0, \"template.html\");\n        }\n      },\n      encapsulation: 2\n    });\n  }\n}","map":{"version":3,"names":["PaymentsComponent","constructor","keycloakService","paymentService","payments","loading","currentPage","pageSize","totalItems","totalPages","statusFilter","selectedPayment","Math","totalPayments","completedPayments","pendingPayments","failedPayments","ngOnInit","loadPayments","getPayments","page","limit","subscribe","next","response","data","filter","p","status","pagination","total","length","error","err","console","viewDetails","payment","refundPayment","paymentId","confirm","reason","alert","goToPage","getPageNumbers","pages","start","max","end","min","i","push","getStatusClass","logout","i0","ɵɵdirectiveInject","i1","KeycloakService","i2","PaymentService","selectors","decls","vars","template","PaymentsComponent_Template","rf","ctx","ɵɵtext"],"sources":["D:\\MLMUPC\\new microService\\my-microservices\\frontend\\admin-web\\src\\app\\components\\payments\\payments.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { KeycloakService } from 'keycloak-angular';\nimport { PaymentService } from '../../services/payment.service';\nimport { Payment } from '../../models';\n\n@Component({\n  selector: 'app-payments',\n  template: 'template.html',\n  styles: []\n})\nexport class PaymentsComponent implements OnInit {\n  payments: Payment[] = [];\n  loading = true;\n  currentPage = 1;\n  pageSize = 10;\n  totalItems = 0;\n  totalPages = 0;\n  statusFilter = '';\n  selectedPayment: Payment | null = null;\n  Math = Math;\n\n  // Stats\n  totalPayments = 0;\n  completedPayments = 0;\n  pendingPayments = 0;\n  failedPayments = 0;\n\n  constructor(\n    private keycloakService: KeycloakService,\n    private paymentService: PaymentService\n  ) {}\n\n  ngOnInit() {\n    this.loadPayments();\n  }\n\n  loadPayments() {\n    this.loading = true;\n    this.paymentService.getPayments({ \n      page: this.currentPage, \n      limit: +this.pageSize \n    }).subscribe({\n      next: (response) => {\n        this.payments = this.statusFilter \n          ? response.data.filter(p => p.status === this.statusFilter)\n          : response.data;\n        this.totalItems = response.pagination.total;\n        this.totalPages = response.pagination.totalPages;\n        \n        // Calculate stats\n        this.totalPayments = response.pagination.total;\n        this.completedPayments = response.data.filter(p => p.status === 'completed').length;\n        this.pendingPayments = response.data.filter(p => p.status === 'pending').length;\n        this.failedPayments = response.data.filter(p => p.status === 'failed').length;\n        \n        this.loading = false;\n      },\n      error: (err) => {\n        console.error('Failed to load payments:', err);\n        this.loading = false;\n      }\n    });\n  }\n\n  viewDetails(payment: Payment) {\n    this.selectedPayment = payment;\n  }\n\n  refundPayment(paymentId: string) {\n    if (!confirm('Are you sure you want to refund this payment?')) return;\n    \n    this.paymentService.refundPayment(paymentId, { reason: 'Admin refund' }).subscribe({\n      next: () => {\n        this.loadPayments();\n      },\n      error: (err) => {\n        console.error('Failed to refund payment:', err);\n        alert('Failed to refund payment');\n      }\n    });\n  }\n\n  goToPage(page: number) {\n    if (page < 1 || page > this.totalPages) return;\n    this.currentPage = page;\n    this.loadPayments();\n  }\n\n  getPageNumbers(): number[] {\n    const pages: number[] = [];\n    const start = Math.max(1, this.currentPage - 2);\n    const end = Math.min(this.totalPages, this.currentPage + 2);\n    for (let i = start; i <= end; i++) {\n      pages.push(i);\n    }\n    return pages;\n  }\n\n  getStatusClass(status: string): string {\n    switch (status) {\n      case 'completed': return 'bg-green-100 text-green-800';\n      case 'pending': return 'bg-yellow-100 text-yellow-800';\n      case 'processing': return 'bg-blue-100 text-blue-800';\n      case 'failed': return 'bg-red-100 text-red-800';\n      case 'refunded': return 'bg-gray-100 text-gray-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  }\n\n  logout() {\n    this.keycloakService.logout();\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}